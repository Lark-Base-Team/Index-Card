import{i as P,B as fe,a as he,p as te,r as i,b as x,u as F,d as y,t as m,c as l,H as $,Z as Ce,I as ae,e as pe,f as ve,g as ge,h as be,j as we,k as xe,q as Ye,l as o,m as Oe,E as Me,n as _,s as V,o as W,v as k,S as O,w as S,D as z,x as oe,y as $e,z as Le,F as E,A as Te,C as U,T as Ie,G as De,J as Ve,K as je,L as ke,M as Re,N as Se,O as Ne,P as Fe,R as He}from"./vendor-DpuxQlqm.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&t(u)}).observe(document,{childList:!0,subtree:!0});function a(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(r){if(r.ep)return;r.ep=!0;const s=a(r);fetch(r.href,s)}})();const Ge="Type & Data",Ae="Data Source",Pe="Data Range",We="Date Filtering",Ee="Date",Be="Create Date",Qe="Modify Date",Ze="Basis",_e="Range",ze="Today",Ue="Yesterday",qe="Current Week",Ke="Last Week",Je="Current Month",Xe="Last Month",et="Current Quarter",tt="Last Quarter",at="Current Year",ot="Last Year",nt="Last 7 Days",st="Last 14 Days",rt="Last 30 Days",lt="Last 365 Days",ct="Last 3 Months",it="Last 6 Months",dt="Statistical Methods",ut="Total Records Count",mt="Field Value Count",yt="Number",ft="Currency",ht="Sum",Ct="Average",pt="Max",vt="Min",gt="MoM & YoY",bt="Add MoM & YoY",wt="Description",xt="Calculation Method",Yt="MoM",Ot="Week YoY",Mt="Month YoY",$t="Year YoY",Lt="Calculation Type",Tt="MoM Growth Rate",It="MoM Growth Value",Dt="MoM Original Value",Vt="Week YoY Growth Value",jt="Month YoY Growth Value",kt="Year YoY Growth Value",Rt="Week YoY Original Value",St="Month YoY Original Value",Nt="Year YoY Original Value",Ft="Week YoY Growth Rate",Ht="Month YoY Growth Rate",Gt="Year YoY Growth Rate",At="Growth Value",Pt="Growth Rate",Wt="Difference Rate",Et="Difference Value",Bt="Original Value",Qt="Custom Style",Zt="Color",_t="Icon Style",zt="Index Data Format",Ut="Decimal Places & Format",qt="Number (Thousands Separator)",Kt="Percentage",Jt="Per Mille",Xt="Prefix",ea="Suffix",ta="Please enter a prefix",aa="Please enter a suffix",oa="Please select a date field",na="Only positive integers are allowed",sa="All Data",ra="Confirm",la={type_Date:Ge,dataSource:Ae,dataRange:Pe,dateFiltering:We,date:Ee,createDate:Be,ModifyDate:Qe,basis:Ze,range:_e,today:ze,yesterday:Ue,currentWeek:qe,lastWeek:Ke,currentMonth:Je,lastMonth:Xe,currentQuarter:et,lastQuarter:tt,currentYear:at,lastYear:ot,last7Days:nt,last14Days:st,last30Days:rt,last365Days:lt,last3Months:ct,last6Months:it,statisticalMethods:dt,recordsTotal:ut,fieldValue:mt,number:yt,currency:ft,sum:ht,average:Ct,max:pt,min:vt,mom_yoy:gt,addMom_Yoy:bt,description:wt,calculation:xt,mom:Yt,weekYoy:Ot,monthYoy:Mt,yearYoy:$t,calculationType:Lt,momGrowthRate:Tt,momGrowthValue:It,momOriginalValue:Dt,weekYoyGrowthValue:Vt,monthYoyGrowthValue:jt,yearYoyGrowthValue:kt,weekYoyOriginalValue:Rt,monthYoyOriginalValue:St,yearYoyOriginalValue:Nt,weekYoyGrowthRate:Ft,monthYoyGrowthRate:Ht,yearYoyGrowthRate:Gt,growthValue:At,growthRate:Pt,differenceRate:Wt,differenceValue:Et,originalValue:Bt,customStyle:Qt,color:Zt,iconStyle:_t,indexDataFormat:zt,decimalPlaces_Format:Ut,numberMillennials:qt,percentage:Kt,millageRate:Jt,prefix:Xt,suffix:ea,prefixPlaceholder:ta,suffixPlaceholder:aa,dataPlaceholder:oa,formatErrorMessage:na,allData:sa,confirm:ra},ca="类型与数据",ia="数据源",da="数据范围",ua="日期筛选",ma="日期",ya="创建日期",fa="修改日期",ha="依据",Ca="范围",pa="今天",va="昨天",ga="本周",ba="上周",wa="本月",xa="上月",Ya="本季度",Oa="上季度",Ma="今年",$a="去年",La="最近7天",Ta="最近14天",Ia="最近30天",Da="最近365天",Va="最近3个月",ja="最近6个月",ka="统计方式",Ra="统计记录总数",Sa="统计字段数值",Na="数字",Fa="货币",Ha="求和",Ga="平均值",Aa="最大值",Pa="最小值",Wa="环同比",Ea="添加环同比",Ba="描述",Qa="计算方式",Za="环比",_a="周同比",za="月同比",Ua="年同比",qa="计算类型",Ka="环比增长率",Ja="环比增长值",Xa="环比原始值",eo="周同比增长值",to="月同比增长值",ao="年同比增长值",oo="周同比原始值",no="月同比原始值",so="年同比原始值",ro="周同比增长率",lo="月同比增长率",co="年同比增长率",io="增长值",uo="增长率",mo="差异率",yo="差异值",fo="原始值",ho="自定义样式",Co="颜色",po="图标样式",vo="指标数据格式",go="小数位与格式",bo="数字（千分位）",wo="百分比",xo="千分比",Yo="前缀",Oo="后缀",Mo="请输入前缀",$o="请输入后缀",Lo="请选择日期字段",To="仅允许输入大于零的整数",Io="全部数据",Do="确定",Vo={type_Date:ca,dataSource:ia,dataRange:da,dateFiltering:ua,date:ma,createDate:ya,ModifyDate:fa,basis:ha,range:Ca,today:pa,yesterday:va,currentWeek:ga,lastWeek:ba,currentMonth:wa,lastMonth:xa,currentQuarter:Ya,lastQuarter:Oa,currentYear:Ma,lastYear:$a,last7Days:La,last14Days:Ta,last30Days:Ia,last365Days:Da,last3Months:Va,last6Months:ja,statisticalMethods:ka,recordsTotal:Ra,fieldValue:Sa,number:Na,currency:Fa,sum:Ha,average:Ga,max:Aa,min:Pa,mom_yoy:Wa,addMom_Yoy:Ea,description:Ba,calculation:Qa,mom:Za,weekYoy:_a,monthYoy:za,yearYoy:Ua,calculationType:qa,momGrowthRate:Ka,momGrowthValue:Ja,momOriginalValue:Xa,weekYoyGrowthValue:eo,monthYoyGrowthValue:to,yearYoyGrowthValue:ao,weekYoyOriginalValue:oo,monthYoyOriginalValue:no,yearYoyOriginalValue:so,weekYoyGrowthRate:ro,monthYoyGrowthRate:lo,yearYoyGrowthRate:co,growthValue:io,growthRate:uo,differenceRate:mo,differenceValue:yo,originalValue:fo,customStyle:ho,color:Co,iconStyle:po,indexDataFormat:vo,decimalPlaces_Format:go,numberMillennials:bo,percentage:wo,millageRate:xo,prefix:Yo,suffix:Oo,prefixPlaceholder:Mo,suffixPlaceholder:$o,dataPlaceholder:Lo,formatErrorMessage:To,allData:Io,confirm:Do},jo="タイプとデータ",ko="データソース",Ro="データ範囲",So="日付フィルタリング",No="日付",Fo="作成日",Ho="更新日",Go="根拠",Ao="範囲",Po="今日",Wo="昨日",Eo="今週",Bo="先週",Qo="今月",Zo="先月",_o="今四半期",zo="前四半期",Uo="今年",qo="去年",Ko="過去7日間",Jo="過去14日間",Xo="過去30日間",en="過去365日間",tn="過去3ヶ月",an="過去6ヶ月",on="統計手法",nn="総レコード数",sn="フィールド数値の集計",rn="数字",ln="通貨",cn="合計",dn="平均値",un="最大値",mn="最小値",yn="環境比と同期比",fn="追加環境比と同期比",hn="説明",Cn="計算方法",pn="環境比",vn="週同期比",gn="月同期比",bn="年同期比",wn="計算タイプ",xn="環境比成長率",Yn="環境比成長値",On="環境比原始値",Mn="週同期比成長値",$n="月同期比成長値",Ln="年同期比成長値",Tn="週同期比原始値",In="月同期比原始値",Dn="年同期比原始値",Vn="週同期比成長率",jn="月同期比成長率",kn="年同期比成長率",Rn="成長値",Sn="成長率",Nn="差異率",Fn="差異値",Hn="原始値",Gn="カスタムスタイル",An="色",Pn="アイコンスタイル",Wn="指標データフォーマット",En="小数点以下の桁数とフォーマット",Bn="数字（千分位）",Qn="パーセンテージ",Zn="パーミレ（千分率）",_n="接頭辞",zn="接尾辞",Un="接頭辞を入力してください",qn="接尾辞を入力してください",Kn="日付フィールドを選択してください",Jn="正の整数のみが許可されます",Xn="全てのデータ",es="確定",ts={type_Date:jo,dataSource:ko,dataRange:Ro,dateFiltering:So,date:No,createDate:Fo,ModifyDate:Ho,basis:Go,range:Ao,today:Po,yesterday:Wo,currentWeek:Eo,lastWeek:Bo,currentMonth:Qo,lastMonth:Zo,currentQuarter:_o,lastQuarter:zo,currentYear:Uo,lastYear:qo,last7Days:Ko,last14Days:Jo,last30Days:Xo,last365Days:en,last3Months:tn,last6Months:an,statisticalMethods:on,recordsTotal:nn,fieldValue:sn,number:rn,currency:ln,sum:cn,average:dn,max:un,min:mn,mom_yoy:yn,addMom_Yoy:fn,description:hn,calculation:Cn,mom:pn,weekYoy:vn,monthYoy:gn,yearYoy:bn,calculationType:wn,momGrowthRate:xn,momGrowthValue:Yn,momOriginalValue:On,weekYoyGrowthValue:Mn,monthYoyGrowthValue:$n,yearYoyGrowthValue:Ln,weekYoyOriginalValue:Tn,monthYoyOriginalValue:In,yearYoyOriginalValue:Dn,weekYoyGrowthRate:Vn,monthYoyGrowthRate:jn,yearYoyGrowthRate:kn,growthValue:Rn,growthRate:Sn,differenceRate:Nn,differenceValue:Fn,originalValue:Hn,customStyle:Gn,color:An,iconStyle:Pn,indexDataFormat:Wn,decimalPlaces_Format:En,numberMillennials:Bn,percentage:Qn,millageRate:Zn,prefix:_n,suffix:zn,prefixPlaceholder:Un,suffixPlaceholder:qn,dataPlaceholder:Kn,formatErrorMessage:Jn,allData:Xn,confirm:es},as={zh:{translation:Vo},en:{translation:la},ja:{translation:ts}};P.use(fe).use(he).init({resources:as,fallbackLng:"en",interpolation:{escapeValue:!1}});te.bridge.getLanguage().then(e=>{P.language!==e&&P.changeLanguage(e)});function q(e){document.body.setAttribute("theme-mode",e)}function os(){const[e,n]=i.useState("#ffffff");return i.useLayoutEffect(()=>{x.getTheme().then(a=>{n(a.chartBgColor),q(a.theme.toLocaleLowerCase())}),x.onThemeChange(a=>{n(a.data.chartBgColor),q(a.data.theme.toLocaleLowerCase())})},[]),{bgColor:e}}const ns=(e,n)=>{e&&(n(e),setTimeout(()=>{x.setRendered()},3e3))};async function ss(e){i.useEffect(()=>{const n=x.onConfigChange(a=>{const t=a.data.customConfig;ns(t,e)});return()=>{n()}},[])}function rs(){const{i18n:e}=F(),n=()=>{e.language==="zh"?y.locale("zh-cn"):y.locale("en-us")};return n(),{i18nLanguage:e.language,setDayjsLocale:n}}var c=(e=>(e.CurrentQuarter="CurrentQuarter",e.LastQuarter="LastQuarter",e.CurrentYear="CurrentYear",e.LastYear="LastYear",e.Last14Days="Last14Days",e.Last365Days="Last365Days",e.Last3Months="Last3Months",e.Last6Months="Last6Months",e))(c||{});const ls=[{label:m("today"),value:l.Today},{label:m("yesterday"),value:l.Yesterday},{label:m("currentWeek"),value:l.CurrentWeek},{label:m("lastWeek"),value:l.LastWeek},{label:m("currentMonth"),value:l.CurrentMonth},{label:m("lastMonth"),value:l.LastMonth},{label:m("currentQuarter"),value:c.CurrentQuarter},{label:m("lastQuarter"),value:c.LastQuarter},{label:m("currentYear"),value:c.CurrentYear},{label:m("lastYear"),value:c.LastYear},{label:m("last7Days"),value:l.TheLastWeek},{label:m("last14Days"),value:c.Last14Days},{label:m("last30Days"),value:l.TheLastMonth},{label:m("last365Days"),value:c.Last365Days},{label:m("last3Months"),value:c.Last3Months},{label:m("last6Months"),value:c.Last6Months}],cs=[{label:m("recordsTotal"),value:"total"},{label:m("fieldValue"),value:"number"}],is=[{label:m("sum"),value:"SUM"},{label:m("average"),value:"AVERAGE"},{label:m("max"),value:"MAX"},{label:m("min"),value:"MIN"}],N=[{label:m("mom"),value:"mom",disabled:!1},{label:m("weekYoy"),value:"yoyByWeek",disabled:!1},{label:m("monthYoy"),value:"yoyByMonth",disabled:!1},{label:m("yearYoy"),value:"yoyByYear",disabled:!1}],ds=[{label:m("differenceRate"),value:"differenceRate"},{label:m("differenceValue"),value:"differenceValue"},{label:m("originalValue"),value:"originalValue"}],ne=[{id:"1",upIcon:"IconTriangleUp",upIconColor:"green",downIcon:"IconTriangleDown",downIconColor:"red",constIcon:"IconMinus",constIconColor:"black"},{id:"2",upIcon:"IconFilledArrowUp",upIconColor:"green",downIcon:"IconFilledArrowDown",downIconColor:"red",constIcon:"IconMinus",constIconColor:"black"},{id:"3",upIcon:"IconArrowUpRight",upIconColor:"green",downIcon:"IconArrowDownRight",downIconColor:"red",constIcon:"IconMinus",constIconColor:"black"},{id:"4",upIcon:"IconTriangleUp",upIconColor:"red",downIcon:"IconTriangleDown",downIconColor:"green",constIcon:"IconMinus",constIconColor:"black"},{id:"5",upIcon:"IconFilledArrowUp",upIconColor:"red",downIcon:"IconFilledArrowDown",downIconColor:"green",constIcon:"IconMinus",constIconColor:"black"},{id:"6",upIcon:"IconArrowUpRight",upIconColor:"red",downIcon:"IconArrowDownRight",downIconColor:"green",constIcon:"IconMinus",constIconColor:"black"}],us={IconMinus:ae,IconTriangleUp:pe,IconTriangleDown:ve,IconFilledArrowUp:ge,IconFilledArrowDown:be,IconArrowUpRight:we,IconArrowDownRight:xe},ms=[{label:m("numberMillennials"),value:"numberMillennials"},{label:m("number"),value:"number"},{label:m("percentage"),value:"percentage"},{label:m("millageRate"),value:"millageRate"}],ys={tableId:"",dateTypeFieldId:"",dateTypeFieldType:$.DateTime,dateRange:l.Today,statisticalType:"total",numberOrCurrencyFieldId:"",statisticalCalcType:Ce.SUM,momOrYoy:[{momOrYoyDesc:m("momGrowthRate"),manualSetDesc:!1,momOrYoyCalcMethod:"mom",momOrYoyCalcType:"differenceRate"}],color:"primary",iconStyleId:"1",decimal:0,numberFormat:"number",prefix:"",suffix:""};y.extend(Ye);const fs=e=>e.replace(/\B(?=(\d{3})+$)/g,","),B=(e,n,a="0.8vmax")=>{const t=us[e];return n?o.jsx(t,{style:{fontSize:n,marginRight:a}}):o.jsx(t,{size:"small",style:{marginRight:a}})},hs=(e,n,a)=>{let t="";if(n==="numberMillennials"){const r=e.toFixed(a).split("."),s=fs(r[0]);t=r.length>1?`${s}.${r[1]}`:s}else n==="number"?t=e.toFixed(a):n==="percentage"?t=(e*100).toFixed(a)+"%":t=(e*1e3).toFixed(a)+"‰";return t},K=e=>[l.Today,l.Yesterday].includes(e)?N:[l.CurrentWeek,l.LastWeek,l.TheLastWeek,c.Last14Days,l.TheLastMonth,c.Last365Days,c.Last3Months,c.Last6Months].includes(e)?N.map(s=>({...s,disabled:s.value!=="mom"})):[c.CurrentQuarter,c.LastQuarter,c.CurrentYear,c.LastYear].includes(e)?N.map(s=>({...s,disabled:s.value==="yoyByWeek"||s.value==="yoyByMonth"})):[l.CurrentMonth,l.LastMonth].includes(e)?N.map(s=>({...s,disabled:s.value==="yoyByWeek"})):[],se=e=>({[l.Today]:()=>{const a=y().startOf("day").valueOf(),t=y().endOf("day").valueOf();return{startTime:a,endTime:t}},[l.Yesterday]:()=>{const a=y().subtract(1,"day").startOf("day").valueOf(),t=y().subtract(1,"day").endOf("day").valueOf();return{startTime:a,endTime:t}},[l.CurrentWeek]:()=>{const a=y().startOf("week").startOf("day").valueOf(),t=y().endOf("week").endOf("day").valueOf();return{startTime:a,endTime:t}},[l.LastWeek]:()=>{const a=y().subtract(1,"week").startOf("week").startOf("day").valueOf(),t=y().subtract(1,"week").endOf("week").endOf("day").valueOf();return{startTime:a,endTime:t}},[l.CurrentMonth]:()=>{const a=y().startOf("month").startOf("day").valueOf(),t=y().endOf("month").endOf("day").valueOf();return{startTime:a,endTime:t}},[l.LastMonth]:()=>{const a=y().subtract(1,"month").startOf("month").startOf("day").valueOf(),t=y().subtract(1,"month").endOf("month").endOf("day").valueOf();return{startTime:a,endTime:t}},[c.CurrentQuarter]:()=>{const a=y().startOf("quarter").startOf("day").valueOf(),t=y().endOf("quarter").endOf("day").valueOf();return{startTime:a,endTime:t}},[c.LastQuarter]:()=>{const a=y().subtract(1,"quarter").startOf("quarter").startOf("day").valueOf(),t=y().subtract(1,"quarter").endOf("quarter").endOf("day").valueOf();return{startTime:a,endTime:t}},[c.CurrentYear]:()=>{const a=y().startOf("year").startOf("day").valueOf(),t=y().endOf("year").endOf("day").valueOf();return{startTime:a,endTime:t}},[c.LastYear]:()=>{const a=y().subtract(1,"year").startOf("year").startOf("day").valueOf(),t=y().subtract(1,"year").endOf("year").endOf("day").valueOf();return{startTime:a,endTime:t}},[l.TheLastWeek]:()=>{const a=y().subtract(6,"day").startOf("day").valueOf(),t=y().endOf("day").valueOf();return{startTime:a,endTime:t}},[c.Last14Days]:()=>{const a=y().subtract(13,"day").startOf("day").valueOf(),t=y().endOf("day").valueOf();return{startTime:a,endTime:t}},[l.TheLastMonth]:()=>{const a=y().subtract(29,"day").startOf("day").valueOf(),t=y().endOf("day").valueOf();return{startTime:a,endTime:t}},[c.Last365Days]:()=>{const a=y().subtract(364,"day").startOf("day").valueOf(),t=y().endOf("day").valueOf();return{startTime:a,endTime:t}},[c.Last3Months]:()=>{const a=y().subtract(3,"month").subtract(1,"day").startOf("day").valueOf(),t=y().endOf("day").valueOf();return{startTime:a,endTime:t}},[c.Last6Months]:()=>{const a=y().subtract(6,"month").subtract(1,"day").startOf("day").valueOf(),t=y().endOf("day").valueOf();return{startTime:a,endTime:t}}})[e](),Cs=e=>{let n=1;return[l.Today,l.Yesterday,l.CurrentWeek,l.LastWeek,l.CurrentMonth,l.LastMonth,c.CurrentQuarter,c.LastQuarter,c.CurrentYear,c.LastYear].includes(e)&&(n=1),e===l.TheLastWeek&&(n=7),e===c.Last14Days&&(n=14),e===l.TheLastMonth&&(n=30),e===c.Last365Days&&(n=365),e===c.Last3Months&&(n=3),e===c.Last6Months&&(n=6),n},ps=(e,n)=>{let a="day";[l.Today,l.Yesterday,l.TheLastWeek,c.Last14Days,l.TheLastMonth,c.Last365Days].includes(e)&&n==="mom"&&(a="day");const r=[l.CurrentWeek,l.LastWeek],s=[l.Today,l.Yesterday];(r.includes(e)&&n==="mom"||s.includes(e)&&n==="yoyByWeek")&&(a="week");const u=[l.CurrentMonth,l.LastMonth,c.Last3Months,c.Last6Months],C=[l.Today,l.Yesterday,l.CurrentMonth,l.LastMonth];(u.includes(e)&&n==="mom"||C.includes(e)&&n==="yoyByMonth")&&(a="month"),[c.CurrentQuarter,c.LastQuarter].includes(e)&&n==="mom"&&(a="quarter");const b=[c.CurrentYear,c.LastYear],g=[l.Today,l.Yesterday,l.CurrentMonth,l.LastMonth,c.CurrentQuarter,c.LastQuarter,c.CurrentYear,c.LastYear];return(b.includes(e)&&n==="mom"||g.includes(e)&&n==="yoyByYear")&&(a="year"),a},vs=(e,n)=>{const a=Cs(e),t=ps(e,n),{startTime:r,endTime:s}=se(e),u=y(r).subtract(a,t).valueOf();let C=y(s).subtract(a,t).valueOf();return t==="month"&&(e===l.CurrentMonth||e===l.LastMonth)&&(C=y(C).endOf("month").endOf("day").valueOf()),t==="quarter"&&(e===c.CurrentQuarter||e===c.LastQuarter)&&(C=y(C).endOf("quarter").endOf("day").valueOf()),{startTime:u,endTime:C}},gs=(e,n,a,t)=>{const r={},s=ne.find(u=>u.id===e);return t===0&&n==="differenceRate"||a===t?(r.icon=s.constIcon,r.color=s.constIconColor):a<t?(r.icon=s.downIcon,r.color=s.downIconColor):(r.icon=s.upIcon,r.color=s.upIconColor),r},bs=(e,n,a,t)=>{let r="";if(e==="differenceRate"){const s=Math.abs((n-a)/a)*100;r=a!==0?`${s.toFixed(t)}%`:""}else if(e==="differenceValue"){const s=Math.abs(n-a);r=s?`${s.toFixed(t)}`:""}else r=`${a.toFixed(t)}`;return r},re=async()=>{const e=await x.getConfig(),n=e.dataConditions[0],a=e.customConfig;return{dataCondition:n,customConfig:a}},le=e=>{const a=[{dateRange:e.dateRange},...e.momOrYoy].map((s,u)=>{let C,h;if(u===0){const g=se(e.dateRange);C=g.startTime,h=g.endTime}else{const g={...s},M=vs(e.dateRange,g.momOrYoyCalcMethod);C=M.startTime,h=M.endTime}return C=C-1,h=h+1,{type:Oe.ALL,filterInfo:{conjunction:Me.And,conditions:[{fieldId:e.dateTypeFieldId,value:C,fieldType:e.dateTypeFieldType,operator:_.IsGreater},{fieldId:e.dateTypeFieldId,value:h,fieldType:e.dateTypeFieldType,operator:_.IsLess}]}}}),t=[{fieldId:e.numberOrCurrencyFieldId,rollup:e.statisticalCalcType}];return a.map(s=>({tableId:e.tableId,dataRange:s,series:e.statisticalType==="number"?t:"COUNTA"}))},ce=(e,n)=>{const a={...n};if(a.tableId=e.tableId,a.statisticalType==="number"){const t=e.series;a.numberOrCurrencyFieldId=t[0].fieldId,a.statisticalCalcType=t[0].rollup}return a},ie=async e=>{var t;const n=le(e),a=[];for(const r of n){const u=(t=(await x.getPreviewData(r))[1])==null?void 0:t.map(C=>C.value);a.push(u!=null&&u.length?u[0]:0)}return a},J=(e,n)=>{let a={mom:m("mom"),yoyByWeek:m("weekYoy"),yoyByMonth:m("monthYoy"),yoyByYear:m("yearYoy")},t={differenceRate:m("growthRate"),differenceValue:m("growthValue"),originalValue:m("originalValue")};return`${a[e]}${t[n]}`},ws=async(e,n)=>{const a=n[0],t=n.slice(1),r=e.momOrYoy.map((u,C)=>{const h=t[C],b=gs(e.iconStyleId,u.momOrYoyCalcType,a,h);return{desc:u.momOrYoyDesc,calcType:u.momOrYoyCalcType,value:bs(u.momOrYoyCalcType,a,h,e.decimal),color:b.color,icon:b.icon}});return{color:e.color,value:hs(a,e.numberFormat,e.decimal),prefix:e.prefix,suffix:e.suffix,momYoyList:r}},Q=async(e,n,a)=>{if(n.filter(r=>r!==void 0).length<=1)return;const t=await ws(e,n);a(t)},X=(e,n,a="D-DIN-Bold")=>{const t=document.createElement("span");t.textContent=e,t.style.fontSize=`${n}vmax`,t.style.fontFamily=a,t.style.visibility="hidden",t.style.whiteSpace="nowrap",document.body.appendChild(t);const r=t.offsetWidth;return document.body.removeChild(t),r},ee=(e,n,a)=>{if(e===0)return a;let t=a,r=X(n,t);for(;e<=r;)t-=1,r=X(n,t);return t},de=[{name:"primary",value:"var(--ccm-chart-N700)"},{name:"blue",value:"var(--ccm-chart-B500)"},{name:"Purple",value:"var(--ccm-chart-I500)"},{name:"green",value:"var(--ccm-chart-G500)"},{name:"cyan",value:"var(--ccm-chart-W500)"},{name:"yellow",value:"var(--ccm-chart-Y500)"},{name:"orange",value:"var(--ccm-chart-O500)"},{name:"red",value:"var(--ccm-chart-R400)"}];function xs(e){return o.jsx("div",{className:"color-picker",children:de.map(({name:n,value:a})=>o.jsx("div",{onClick:()=>{e.onChange(n)},style:{borderColor:e.name===n?a:"transparent"},className:"color-picker-color-container",children:o.jsx("div",{style:{backgroundColor:a},className:"color-picker-color",children:e.name===n?o.jsx("div",{className:"selected-icon-container"}):null})},n))})}function Ys({renderData:e,mainDomRef:n}){var C;const a=x.state===V.Config||x.state===V.Create,t=i.useRef(null),r=i.useRef(null),s=W(()=>{var g,M;const h=`${e.prefix}${e.value}${e.suffix}`;let b=26;if(a){const I=((g=t.current)==null?void 0:g.offsetWidth)||0;b=ee(I,h,14)}else{const I=((M=n.current)==null?void 0:M.offsetWidth)||0;b=ee(I,h,26)}r.current&&(r.current.style.fontSize=`${b}vmax`)},200),u=()=>{s()};return i.useEffect(()=>(u(),window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)}),[e]),o.jsx("div",{className:"main-content",ref:t,children:o.jsxs("div",{className:k({"main-content-warp":!0,"is-config":a}),children:[o.jsx("div",{ref:r,className:"main-content-number text-hidden",style:{color:(C=de.find(h=>h.name===e.color))==null?void 0:C.value},children:`${e.prefix}${e.value}${e.suffix}`}),e.momYoyList.map((h,b)=>o.jsxs("div",{className:"main-content-description text-hidden",children:[o.jsx("div",{className:"description-text",children:h.desc}),o.jsxs("div",{className:k("description-index",h.color),children:[h.calcType==="originalValue"?null:B(h.icon,"1.8vmax",h.value?void 0:"0"),o.jsx("div",{className:"description-index-number",children:h.value})]})]},b))]})})}const Os=e=>i.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},i.createElement("path",{d:"M1.33203 2.66634C1.33203 1.92996 1.92898 1.33301 2.66536 1.33301H13.332C14.0684 1.33301 14.6654 1.92996 14.6654 2.66634V13.333C14.6654 14.0694 14.0684 14.6663 13.332 14.6663H2.66536C1.92899 14.6663 1.33203 14.0694 1.33203 13.333V2.66634ZM2.66536 2.66634V13.333H13.332V2.66634H2.66536Z",fill:"#646A73"}),i.createElement("path",{d:"M8.33203 4.66634C7.96384 4.66634 7.66536 4.96482 7.66536 5.33301C7.66536 5.7012 7.96384 5.99967 8.33203 5.99967H11.332C11.7002 5.99967 11.9987 5.7012 11.9987 5.33301C11.9987 4.96482 11.7002 4.66634 11.332 4.66634H8.33203Z",fill:"#646A73"}),i.createElement("path",{d:"M3.9987 5.33301C3.9987 4.96482 4.29718 4.66634 4.66536 4.66634H5.9987C6.36689 4.66634 6.66536 4.96482 6.66536 5.33301C6.66536 5.7012 6.36689 5.99967 5.9987 5.99967H4.66536C4.29717 5.99967 3.9987 5.7012 3.9987 5.33301Z",fill:"#646A73"}),i.createElement("path",{d:"M8.33203 7.33301C7.96384 7.33301 7.66536 7.63148 7.66536 7.99967C7.66536 8.36786 7.96384 8.66634 8.33203 8.66634H11.332C11.7002 8.66634 11.9987 8.36786 11.9987 7.99967C11.9987 7.63148 11.7002 7.33301 11.332 7.33301H8.33203Z",fill:"#646A73"}),i.createElement("path",{d:"M3.9987 7.99967C3.9987 7.63148 4.29718 7.33301 4.66536 7.33301H5.9987C6.36689 7.33301 6.66536 7.63148 6.66536 7.99967C6.66536 8.36786 6.36689 8.66634 5.9987 8.66634H4.66536C4.29717 8.66634 3.9987 8.36786 3.9987 7.99967Z",fill:"#646A73"}),i.createElement("path",{d:"M8.33203 9.99967C7.96384 9.99967 7.66536 10.2982 7.66536 10.6663C7.66536 11.0345 7.96384 11.333 8.33203 11.333H11.332C11.7002 11.333 11.9987 11.0345 11.9987 10.6663C11.9987 10.2982 11.7002 9.99967 11.332 9.99967H8.33203Z",fill:"#646A73"}),i.createElement("path",{d:"M3.9987 10.6663C3.9987 10.2982 4.29718 9.99967 4.66536 9.99967H5.9987C6.36689 9.99967 6.66536 10.2982 6.66536 10.6663C6.66536 11.0345 6.36689 11.333 5.9987 11.333H4.66536C4.29717 11.333 3.9987 11.0345 3.9987 10.6663Z",fill:"#646A73"})),Ms=e=>i.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},i.createElement("path",{d:"M5.85044 1.42649C6.21505 1.47773 6.46908 1.81485 6.41784 2.17945L6.16192 4.00039H10.8155L11.0975 1.99389C11.1487 1.62928 11.4858 1.37525 11.8504 1.42649C12.215 1.47773 12.4691 1.81485 12.4178 2.17945L12.1619 4.00039H14.668C15.0362 4.00039 15.3346 4.29887 15.3346 4.66706C15.3346 5.03525 15.0362 5.33373 14.668 5.33373H11.9745L11.3187 10.0004H13.3346C13.7028 10.0004 14.0013 10.2989 14.0013 10.6671C14.0013 11.0353 13.7028 11.3337 13.3346 11.3337H11.1313L10.7478 14.0627C10.6965 14.4273 10.3594 14.6813 9.9948 14.6301C9.63019 14.5788 9.37616 14.2417 9.4274 13.8771L9.78485 11.3337H5.13129L4.74776 14.0627C4.69652 14.4273 4.35941 14.6813 3.9948 14.6301C3.63019 14.5788 3.37616 14.2417 3.4274 13.8771L3.78485 11.3337H1.33464C0.966446 11.3337 0.667969 11.0353 0.667969 10.6671C0.667969 10.2989 0.966446 10.0004 1.33464 10.0004H3.97224L4.6281 5.33373H2.66797C2.29978 5.33373 2.0013 5.03525 2.0013 4.66706C2.0013 4.29887 2.29978 4.00039 2.66797 4.00039H4.81548L5.09748 1.99389C5.14872 1.62928 5.48583 1.37525 5.85044 1.42649ZM9.97224 10.0004L10.6281 5.33373H5.97453L5.31868 10.0004H9.97224Z",fill:"#646A73"})),$s=e=>i.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},i.createElement("path",{d:"M10.5133 4.97503C10.6838 4.69088 10.5917 4.32233 10.3075 4.15184C10.0234 3.98135 9.6548 4.07349 9.48431 4.35764L8.09498 6.6732C8.06364 6.66868 8.0316 6.66634 7.99902 6.66634C7.96626 6.66634 7.93406 6.66871 7.90257 6.67327L6.51319 4.35764C6.3427 4.07349 5.97414 3.98135 5.68999 4.15184C5.40585 4.32233 5.31371 4.69089 5.4842 4.97504L6.69898 6.99967H5.26536C4.93399 6.99967 4.66536 7.2683 4.66536 7.59967C4.66536 7.93105 4.93399 8.19967 5.26536 8.19967H7.33265L7.33247 9.33301H5.26536C4.93399 9.33301 4.66536 9.60164 4.66536 9.93301C4.66536 10.2644 4.93399 10.533 5.26536 10.533H7.33228L7.33205 12C7.33199 12.368 7.6303 12.6663 7.99829 12.6663C8.3662 12.6663 8.66447 12.3681 8.66453 12.0002L8.66476 10.533H10.732C11.0634 10.533 11.332 10.2644 11.332 9.93301C11.332 9.60164 11.0634 9.33301 10.732 9.33301H8.66495L8.66512 8.19967H10.732C11.0634 8.19967 11.332 7.93105 11.332 7.59967C11.332 7.2683 11.0634 6.99967 10.732 6.99967H9.29852L10.5133 4.97503Z",fill:"#646A73"}),i.createElement("path",{d:"M15.6654 7.99967C15.6654 12.2339 12.2329 15.6663 7.9987 15.6663C3.76452 15.6663 0.332031 12.2339 0.332031 7.99967C0.332031 3.76549 3.76452 0.333008 7.9987 0.333008C12.2329 0.333008 15.6654 3.76549 15.6654 7.99967ZM1.66536 7.99967C1.66536 11.4975 4.50089 14.333 7.9987 14.333C11.4965 14.333 14.332 11.4975 14.332 7.99967C14.332 4.50187 11.4965 1.66634 7.9987 1.66634C4.50089 1.66634 1.66536 4.50187 1.66536 7.99967Z",fill:"#646A73"})),Ls=e=>i.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},i.createElement("path",{d:"M7.33464 4.33301C7.33464 2.67373 8.68674 1.33301 10.3412 1.33301C11.9884 1.33301 13.3346 2.6679 13.3346 4.31999V4.33301C13.3346 4.7012 13.0362 4.99967 12.668 4.99967C12.2998 4.99967 12.0013 4.7012 12.0013 4.33301V4.31999C12.0013 3.40913 11.2569 2.66634 10.3412 2.66634C9.41826 2.66634 8.66797 3.41496 8.66797 4.33301V6.66634H11.3346C11.7028 6.66634 12.0013 6.96482 12.0013 7.33301C12.0013 7.7012 11.7028 7.99967 11.3346 7.99967H8.66797V11.6663C8.66797 13.3256 7.31587 14.6663 5.66144 14.6663C4.0142 14.6663 2.66797 13.3314 2.66797 11.6794V11.6663C2.66797 11.2982 2.96645 10.9997 3.33464 10.9997C3.70283 10.9997 4.0013 11.2982 4.0013 11.6663V11.6794C4.0013 12.5902 4.74573 13.333 5.66144 13.333C6.58434 13.333 7.33464 12.5844 7.33464 11.6663L7.33464 7.99967H5.33464C4.96645 7.99967 4.66797 7.7012 4.66797 7.33301C4.66797 6.96482 4.96645 6.66634 5.33464 6.66634H7.33464V4.33301Z",fill:"#646A73"})),Ts=e=>i.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},i.createElement("path",{d:"M4.66536 1.3335C5.03355 1.3335 5.33203 1.63197 5.33203 2.00016H10.6654C10.6654 1.63197 10.9638 1.3335 11.332 1.3335C11.7002 1.3335 11.9987 1.63197 11.9987 2.00016C12.2748 2.00016 12.8119 2.00016 13.3321 2.00016C14.0684 2.00016 14.6654 2.59712 14.6654 3.3335V13.3335C14.6654 14.0699 14.0684 14.6668 13.332 14.6668H2.66536C1.92899 14.6668 1.33203 14.0699 1.33203 13.3335L1.33203 3.3335C1.33203 2.59712 1.92896 2.00016 2.66534 2.00016C3.18554 2.00016 3.72257 2.00016 3.9987 2.00016C3.9987 1.63197 4.29717 1.3335 4.66536 1.3335ZM10.6654 3.3335H5.33203C5.33203 3.70169 5.03355 4.00016 4.66536 4.00016C4.29717 4.00016 3.9987 3.70169 3.9987 3.3335H2.66536V13.3335H13.332V3.3335H11.9987C11.9987 3.70169 11.7002 4.00016 11.332 4.00016C10.9638 4.00016 10.6654 3.70169 10.6654 3.3335ZM5.9987 10.0002C5.9987 9.63197 5.70022 9.3335 5.33203 9.3335H4.66536C4.29717 9.3335 3.9987 9.63197 3.9987 10.0002V10.6668C3.9987 11.035 4.29717 11.3335 4.66536 11.3335H5.33203C5.70022 11.3335 5.9987 11.035 5.9987 10.6668V10.0002ZM6.9987 6.66683C6.9987 6.29864 7.29718 6.00016 7.66536 6.00016H8.33203C8.70022 6.00016 8.9987 6.29864 8.9987 6.66683V7.3335C8.9987 7.70169 8.70022 8.00016 8.33203 8.00016H7.66536C7.29717 8.00016 6.9987 7.70169 6.9987 7.3335V6.66683ZM8.9987 10.0002C8.9987 9.63197 8.70022 9.3335 8.33203 9.3335H7.66536C7.29717 9.3335 6.9987 9.63197 6.9987 10.0002V10.6668C6.9987 11.035 7.29718 11.3335 7.66536 11.3335H8.33203C8.70022 11.3335 8.9987 11.035 8.9987 10.6668V10.0002ZM9.9987 10.0002C9.9987 9.63197 10.2972 9.3335 10.6654 9.3335H11.332C11.7002 9.3335 11.9987 9.63197 11.9987 10.0002V10.6668C11.9987 11.035 11.7002 11.3335 11.332 11.3335H10.6654C10.2972 11.3335 9.9987 11.035 9.9987 10.6668V10.0002ZM11.9987 6.66683C11.9987 6.29864 11.7002 6.00016 11.332 6.00016H10.6654C10.2972 6.00016 9.9987 6.29864 9.9987 6.66683V7.3335C9.9987 7.70169 10.2972 8.00016 10.6654 8.00016H11.332C11.7002 8.00016 11.9987 7.70169 11.9987 7.3335V6.66683Z",fill:"#646A73"})),Is=e=>i.createElement("svg",{width:16,height:17,viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},i.createElement("path",{d:"M5.33203 2.49967C5.33203 2.13148 5.03355 1.83301 4.66536 1.83301C4.29717 1.83301 3.9987 2.13148 3.9987 2.49967H2.66534C1.92896 2.49967 1.33203 3.09663 1.33203 3.83301V13.833C1.33203 14.5694 1.92899 15.1663 2.66536 15.1663H7.83512C7.51362 14.7653 7.24887 14.3168 7.05304 13.833H2.66536V3.83301H3.9987C3.9987 4.2012 4.29717 4.49967 4.66536 4.49967C5.03355 4.49967 5.33203 4.2012 5.33203 3.83301H10.6654C10.6654 4.2012 10.9638 4.49967 11.332 4.49967C11.7002 4.49967 11.9987 4.2012 11.9987 3.83301H13.332V6.6677C13.8051 6.78945 14.2527 6.97446 14.6654 7.21318V3.83301C14.6654 3.09663 14.0684 2.49967 13.3321 2.49967H11.9987C11.9987 2.13148 11.7002 1.83301 11.332 1.83301C10.9638 1.83301 10.6654 2.13148 10.6654 2.49967H5.33203Z",fill:"#646A73"}),i.createElement("path",{d:"M5.33203 9.16634C5.70022 9.16634 5.9987 9.46482 5.9987 9.83301V10.4997C5.9987 10.8679 5.70022 11.1663 5.33203 11.1663H4.66536C4.29717 11.1663 3.9987 10.8679 3.9987 10.4997V9.83301C3.9987 9.46482 4.29717 9.16634 4.66536 9.16634H5.33203Z",fill:"#646A73"}),i.createElement("path",{d:"M4.66536 5.83301C4.29718 5.83301 3.9987 6.13148 3.9987 6.49967V7.16634C3.9987 7.53453 4.29717 7.83301 4.66536 7.83301H5.33203C5.70022 7.83301 5.9987 7.53453 5.9987 7.16634V6.49967C5.9987 6.13148 5.70022 5.83301 5.33203 5.83301H4.66536Z",fill:"#646A73"}),i.createElement("path",{d:"M11.332 10.4997C11.332 10.1315 11.6305 9.83301 11.9987 9.83301C12.3669 9.83301 12.6654 10.1315 12.6654 10.4997V11.1663H13.332C13.7002 11.1663 13.9987 11.4648 13.9987 11.833C13.9987 12.2012 13.7002 12.4997 13.332 12.4997H11.9987C11.6305 12.4997 11.332 12.2012 11.332 11.833V10.4997Z",fill:"#646A73"}),i.createElement("path",{d:"M11.9987 15.833C14.2078 15.833 15.9987 14.0421 15.9987 11.833C15.9987 9.62387 14.2078 7.83301 11.9987 7.83301C9.78956 7.83301 7.9987 9.62387 7.9987 11.833C7.9987 14.0421 9.78956 15.833 11.9987 15.833ZM11.9987 14.4997C10.5259 14.4997 9.33203 13.3058 9.33203 11.833C9.33203 10.3602 10.5259 9.16634 11.9987 9.16634C13.4715 9.16634 14.6654 10.3602 14.6654 11.833C14.6654 13.3058 13.4715 14.4997 11.9987 14.4997Z",fill:"#646A73"}),i.createElement("path",{d:"M9.33203 6.49967C9.33203 6.13148 9.03355 5.83301 8.66536 5.83301H7.9987C7.63051 5.83301 7.33203 6.13148 7.33203 6.49967V7.16634C7.33203 7.53453 7.63051 7.83301 7.9987 7.83301H8.66536C9.03356 7.83301 9.33203 7.53453 9.33203 7.16634V6.49967Z",fill:"#646A73"}));function Ds({config:e,setConfig:n,tableList:a,dateTypeList:t,numberOrCurrencyList:r,setData:s}){const{t:u}=F(),[C,h]=i.useState(K(e.dateRange)),b=async d=>{e.tableId=d,s(e)},g=(d,v)=>{var p;if(d==="dateTypeFieldId"){const f=(p=t.find(w=>w.fieldId===v))==null?void 0:p.fieldType;n({...e,[d]:v,dateTypeFieldType:f})}n({...e,[d]:v})},M=d=>{h(K(d));const v=e.momOrYoy.map(p=>(p.momOrYoyCalcMethod="mom",p.momOrYoyDesc="",p.manualSetDesc||(p.momOrYoyDesc=J(p.momOrYoyCalcMethod,p.momOrYoyCalcType)),p));n({...e,dateRange:d,momOrYoy:v})},T=(d,v,p,f)=>{d={...d,[v]:p},v==="momOrYoyDesc"&&(d.manualSetDesc=!0);const{manualSetDesc:w,momOrYoyCalcMethod:Y,momOrYoyCalcType:L}=d;w||(d.momOrYoyDesc=J(Y,L)),e.momOrYoy[f]=d,n({...e})},I=i.useRef(null),R=()=>{const d={momOrYoyDesc:u("momGrowthRate"),manualSetDesc:!1,momOrYoyCalcMethod:"mom",momOrYoyCalcType:"differenceRate"};e.momOrYoy.push(d),n({...e}),setTimeout(()=>{var v;(v=I.current)==null||v.scrollIntoView({behavior:"smooth"})},0)},H=d=>{e.momOrYoy.splice(d,1),n({...e})},G=d=>{var f;const v={[$.Number]:o.jsx(Ms,{}),[$.Currency]:o.jsx($s,{}),[$.Formula]:o.jsx(Ls,{})},p=(f=r.find(w=>w.fieldId===d))==null?void 0:f.fieldType;return v[p]};return o.jsxs("div",{className:"form-main",children:[o.jsx("div",{className:"form-title",children:u("dataSource")}),o.jsx("div",{className:"form-item",children:o.jsx(O,{prefix:o.jsx(S,{svg:o.jsx(Os,{})}),optionList:a,value:e.tableId,onChange:b})}),o.jsx(z,{style:{borderColor:"var(--divider)",marginTop:"12px"}}),o.jsx("div",{className:"form-title",children:u("dateFiltering")}),o.jsxs("div",{className:"form-item",children:[o.jsx("div",{className:"form-subTitle",children:u("basis")}),o.jsx(O,{placeholder:u("dataPlaceholder"),prefix:o.jsx(S,{svg:o.jsx(Ts,{})}),value:e.dateTypeFieldId,onChange:d=>{g("dateTypeFieldId",d)},children:t.map(d=>o.jsx(O.Option,{value:d.fieldId,children:d.fieldName},d.fieldId))}),o.jsxs("div",{className:"form-item",children:[o.jsx("div",{className:"form-subTitle",children:u("range")}),o.jsx(O,{optionList:ls,prefix:o.jsx(S,{svg:o.jsx(Is,{})}),value:e.dateRange,onChange:M})]})]}),o.jsx("div",{className:"form-title",children:u("statisticalMethods")}),o.jsx("div",{className:"form-item",children:o.jsx(O,{optionList:cs,value:e.statisticalType,onChange:d=>{g("statisticalType",d)}})}),e.statisticalType==="number"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"form-item noBorder",children:o.jsx(O,{optionList:is,value:e.statisticalCalcType,onChange:d=>g("statisticalCalcType",d)})}),o.jsx("div",{className:"form-item",children:o.jsx(O,{prefix:o.jsx(S,{svg:G(e.numberOrCurrencyFieldId)}),value:e.numberOrCurrencyFieldId,onChange:d=>{g("numberOrCurrencyFieldId",d)},children:r.map(d=>o.jsx(O.Option,{value:d.fieldId,children:d.fieldName},d.fieldId))})})]}),o.jsx(z,{style:{borderColor:"var(--divider)",margin:"12px 0 20px 0"}}),o.jsxs("div",{className:"form-title",children:[o.jsx("span",{children:u("mom_yoy")}),o.jsx(oe,{disabled:e.momOrYoy.length>=4,theme:"borderless",icon:o.jsx($e,{size:"small"}),style:{fontWeight:"normal"},onClick:R,children:u("addMom_Yoy")})]}),e.momOrYoy&&e.momOrYoy.map((d,v)=>o.jsxs("div",{className:"form-item bg-grey",children:[e.momOrYoy.length>1&&o.jsx("div",{className:"icon-delete",onClick:()=>{H(v)},children:o.jsx(Le,{size:"small"})}),o.jsx("div",{className:"form-subTitle",children:u("description")}),o.jsx(E,{value:d.momOrYoyDesc,onChange:p=>{T(d,"momOrYoyDesc",p,v)}}),o.jsx("div",{className:"form-subTitle",children:u("calculation")}),o.jsx(O,{position:"top",optionList:C,value:d.momOrYoyCalcMethod,onChange:p=>T(d,"momOrYoyCalcMethod",p,v)}),o.jsx("div",{className:"form-subTitle",children:u("calculationType")}),o.jsx(O,{position:"top",optionList:ds,value:d.momOrYoyCalcType,onChange:p=>T(d,"momOrYoyCalcType",p,v)}),o.jsx("div",{ref:I})]},v))]})}function Vs({config:e,setConfig:n}){const{t:a}=F(),t=(s,u)=>{n({...e,[s]:u})},r=s=>`${s}`.replace(/\D/g,"");return o.jsxs("div",{className:"form-main",children:[o.jsx("div",{className:"form-title",children:a("color")}),o.jsx("div",{className:"form-item",style:{margin:"6px 0 18px 0"},children:o.jsx(xs,{onChange:s=>{t("color",s)},name:e.color})}),o.jsx("div",{className:"form-title",children:a("iconStyle")}),o.jsx("div",{className:"form-item",children:o.jsx(O,{value:e.iconStyleId,onChange:s=>{t("iconStyleId",s)},children:ne.map(s=>o.jsx(O.Option,{value:s.id,children:o.jsxs("div",{className:"index-icon",children:[o.jsxs("div",{className:k("index-icon-item",s.upIconColor),children:[B(s.upIcon),o.jsx("div",{className:"number",children:"10"})]}),o.jsxs("div",{className:k("index-icon-item",s.constIconColor),children:[o.jsx(ae,{size:"small"}),o.jsx("div",{className:"number",children:"0"})]}),o.jsxs("div",{className:k("index-icon-item",s.downIconColor),children:[B(s.downIcon),o.jsx("div",{className:"number",children:"10"})]})]})},s.id))})}),o.jsx("div",{className:"form-title",children:a("indexDataFormat")}),o.jsxs("div",{className:"form-item",children:[o.jsx("div",{className:"form-subTitle",children:a("decimalPlaces_Format")}),o.jsxs("div",{className:"flex-between",children:[o.jsx(Te,{style:{marginRight:"10px",flex:1},value:e.decimal,formatter:r,onNumberChange:s=>{t("decimal",s)},min:0,max:5}),o.jsx(O,{value:e.numberFormat,style:{flex:1},onChange:s=>{t("numberFormat",s)},children:ms.map(s=>o.jsx(O.Option,{value:s.value,children:s.label},s.value))})]})]}),o.jsxs("div",{className:"flex-between",children:[o.jsxs("div",{className:"form-item",style:{marginRight:"10px"},children:[o.jsx("div",{className:"form-subTitle",children:a("prefix")}),o.jsx(E,{value:e.prefix,placeholder:a("prefixPlaceholder"),onChange:s=>{t("prefix",s)}})]}),o.jsxs("div",{className:"form-item",children:[o.jsx("div",{className:"form-subTitle",children:a("suffix")}),o.jsx(E,{value:e.suffix,placeholder:a("suffixPlaceholder"),onChange:s=>{t("suffix",s)}})]})]})]})}function js({setRenderData:e}){const{t:n}=F(),a=[{key:"1",tab:n("type_Date")},{key:"2",tab:n("customStyle")}],[t,r]=i.useState(ys);ss(r);const s=()=>{if(!t.dateTypeFieldId){Ve.error(n("dataPlaceholder"));return}const f=le(t)[0];x.saveConfig({customConfig:t,dataConditions:f})},[u,C]=i.useState([]),[h,b]=i.useState([]),[g,M]=i.useState([]),T=i.useCallback(async()=>{const f=await U.getTableList(),w=[];for(const Y of f){const L=await Y.getName();w.push({value:Y.id,label:L})}return w},[]),I=i.useCallback(async f=>{const w=await x.getCategories(f),Y=[$.DateTime,$.CreatedTime,$.ModifiedTime],L=w.filter(D=>Y.includes(D.fieldType))||[],j=[$.Number,$.Currency,$.Formula],ue=w.filter(D=>j.includes(D.fieldType))||[],me=await(await U.getTable(f)).getRecordList(),A=[];for(const D of ue)for(const ye of me){const Z=await(await ye.getCellByField(D.fieldId)).getValue();(D.fieldType===$.Number||D.fieldType===$.Currency||typeof Z=="number"&&Number.isFinite(Z))&&A.push(D);break}return{dateTypeList:L,numberOrCurrencyList:A}},[]),R=async(f,w=!0)=>{const{dateTypeList:Y,numberOrCurrencyList:L}=await I(f.tableId);if(b(Y),M(L),w){f.dateTypeFieldId=Y[0].fieldId||"";const j=L.length>0;f.statisticalType=j?"number":"total",j&&(f.numberOrCurrencyFieldId=L[0].fieldId)}r({...f})},H=async()=>{var w;const f=await T();if(C(f),x.state===V.Create){const Y={...t};Y.tableId=(w=f[0])==null?void 0:w.value,R(Y)}else{const{dataCondition:Y,customConfig:L}=await re(),j=ce(Y,L);R(j,!1)}};i.useEffect(()=>{H()},[T,I]);const[G,d]=i.useState([]),v=W(async()=>{if(!t.tableId)return;const f=await ie(t);d(f),Q(t,f,e)},200);i.useEffect(()=>{v()},[t.tableId,t.dateTypeFieldId,t.dateTypeFieldType,t.dateRange,t.statisticalType,t.numberOrCurrencyFieldId,t.statisticalCalcType,JSON.stringify(t.momOrYoy)]);const p=W(()=>{t.tableId&&Q(t,G,e)},200);return i.useEffect(()=>{p()},[t.color,t.iconStyleId,t.decimal,t.numberFormat,t.prefix,t.suffix]),o.jsxs("div",{className:"main-config-panel left-border",children:[o.jsx("div",{className:"form",children:o.jsx(Ie,{defaultActiveKey:"1",children:a.map(f=>o.jsxs(De,{tab:f.tab,itemKey:f.key,children:[f.key==="1"&&o.jsx(Ds,{config:t,setConfig:r,tableList:u,dateTypeList:h,numberOrCurrencyList:g,setData:R}),f.key==="2"&&o.jsx(Vs,{config:t,setConfig:r})]},f.key))})}),o.jsx(oe,{className:"btn",theme:"solid",onClick:s,children:n("confirm")})]})}function ks(){const{bgColor:e}=os(),n=x.state===V.Config||x.state===V.Create,[a,t]=i.useState({color:"primary",value:"",prefix:"",suffix:"",momYoyList:[]}),r=i.useRef(null),s=async()=>{const{dataCondition:b,customConfig:g}=await re(),M=ce(b,g),T=await ie(M);Q(M,T,t)},u=async()=>{s()},{i18nLanguage:C,setDayjsLocale:h}=rs();return i.useEffect(()=>{h(),(x.state===V.View||x.state===V.FullScreen)&&(s(),x.onDataChange(u))},[C]),o.jsxs("main",{className:k(n?"top-border":"","main"),style:{backgroundColor:e},ref:r,children:[o.jsx(Ys,{renderData:a,mainDomRef:r}),n&&o.jsx(js,{setRenderData:t})]})}function Rs(e){const[n,a]=i.useState(je);return i.useEffect(()=>{if(e.neverShowBanner)return;const t=new Promise((r,s)=>{setTimeout(()=>{s(!1)},3e3)});Promise.race([te.bridge.getLanguage(),t]).then(r=>{r==="zh"&&a(ke),r==="ja"&&a(Re)}).catch(r=>{console.error(r)})},[]),e.neverShowBanner?e.children||null:o.jsx("div",{children:o.jsx(Se,{locale:n,children:e.children})})}const Ss=Ne([{path:"/",element:o.jsx(ks,{})}]),Ns=Fe.createRoot(document.getElementById("root"));Ns.render(o.jsx(Rs,{children:o.jsx(He,{router:Ss})}));
